import{j as n,v as H,r as l}from"./chunk-2c335c07.js";import{j as D,c as N,N as Ue,O as Ye,e as ze,f as Ve,g as We,_ as Je}from"./chunk-7156cdf0.js";import{$ as Ee,a as $e,b as se,d as ce,e as Qe,f as Re,g as De,D as Ze}from"./chunk-055198c7.js";function xe(t){const e={blockquote:"blockquote",code:"code",h1:"h1",li:"li",p:"p",ul:"ul",...t.components};return n.jsxs(n.Fragment,{children:[n.jsx(e.h1,{children:"Welcome to Open Chat Docs!"}),`
`,n.jsxs(e.blockquote,{children:[`
`,n.jsx(e.p,{children:"Docs are still work in progress feel free to open a PR"}),`
`]}),`
`,n.jsx(e.p,{children:"Generaly the repo comes with 3 services:"}),`
`,n.jsxs(e.ul,{children:[`
`,n.jsxs(e.li,{children:[n.jsx(e.code,{children:"backend"}),": ",n.jsx(H,{href:"https://www.djangoproject.com/",target:"_blank",children:"Django"})," + Rest-Framework + Django-Channels"]}),`
`,n.jsxs(e.li,{children:[n.jsx(e.code,{children:"frontend"}),": Express + Vike"]}),`
`,n.jsxs(e.li,{children:[n.jsx(e.code,{children:"proxy"}),": Nginx"]}),`
`]}),`
`,n.jsxs(e.p,{children:["All components are containerized, check ",n.jsx(H,{href:"/docs/dev-docker",children:"docker development"}),"."]})]})}function en(t={}){const{wrapper:e}=t.components||{};return e?n.jsx(e,{...t,children:n.jsx(xe,{...t})}):xe(t)}function ge(t){const e={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...t.components};return n.jsxs(n.Fragment,{children:[n.jsx(e.h1,{children:"Docker Development"}),`
`,n.jsxs(e.blockquote,{children:[`
`,n.jsx(e.p,{children:"âœ… recommended way to develop for web!"}),`
`]}),`
`,n.jsx(e.pre,{children:n.jsx(e.code,{className:"language-bash",children:`docker compose up --build
`})}),`
`,n.jsxs(e.p,{children:["Visit ",n.jsx(e.code,{children:"localhost"})," ( http port 80 ), live reload & dev mode enabled by default."]}),`
`,n.jsx(e.h2,{children:"Build the docs"}),`
`,n.jsxs(e.p,{children:["Creates a full static export of docs in ",n.jsx(e.code,{children:"./docs"}),"."]}),`
`,n.jsx(e.pre,{children:n.jsx(e.code,{className:"language-bash",children:`docker compose build frontend
docker compose run --entrypoint sh frontend -c "npm install && npm run build:docs"
`})}),`
`,n.jsxs(e.p,{children:["Then view it with any statics server, e.g.: ",n.jsx(e.code,{children:"cd ./docs && php -S localhost:8080"})]}),`
`,n.jsx(e.h2,{children:"Capacitor Development"}),`
`,n.jsx(e.p,{children:"Be sure to have all required android build tools installed, check capacitor docs for more info."}),`
`,n.jsx(e.pre,{children:n.jsx(e.code,{className:"language-bash",children:`npx cap sync
npx cap run android -l --external
`})}),`
`,n.jsx(e.h2,{children:"Shell in container"}),`
`,n.jsxs(e.ol,{children:[`
`,n.jsxs(e.li,{children:["Shell on container ",n.jsx(e.code,{children:"docker compose exec <service> sh"})]}),`
`,n.jsxs(e.li,{children:["Do stuff e.g.: ",n.jsx(e.em,{children:"Install Packages"})," ",n.jsx(e.code,{children:"pip3 install ..."})," / ",n.jsx(e.code,{children:"npm run dev"})]}),`
`]}),`
`,n.jsx(e.h2,{children:"Updating Api Client"}),`
`,n.jsxs(e.p,{children:["Generate typed api client outside the container: ",n.jsx(e.code,{children:"cd frontend && npm run generate-api"}),", consider:"]}),`
`,n.jsxs(e.ol,{children:[`
`,n.jsx(e.li,{children:"updates to the api client should be commited"}),`
`,n.jsxs(e.li,{children:["Api is generated based in infered types from ",n.jsx(e.code,{children:"rest_framework"})," and ",n.jsx(e.code,{children:"drf_spectacular"})]}),`
`,n.jsxs(e.li,{children:["Use ",n.jsx(e.code,{children:"rest_framework.serializers"})," ( and ",n.jsx(e.code,{children:"ModelSerializer"})," ) where possible"]}),`
`,n.jsxs(e.li,{children:["Use ",n.jsx(e.code,{children:"drf_spectacular.utils.extend_schema"})," to extend incomplete schemas"]}),`
`]}),`
`,n.jsxs(e.p,{children:["View the swagger-ui at ",n.jsx(e.code,{children:"/api/schema/swagger-ui/"})]})]})}function nn(t={}){const{wrapper:e}=t.components||{};return e?n.jsx(e,{...t,children:n.jsx(ge,{...t})}):ge(t)}function be(t){const e={code:"code",h1:"h1",li:"li",ol:"ol",p:"p",pre:"pre",...t.components};return n.jsxs(n.Fragment,{children:[n.jsx(e.h1,{children:"Capacitor Native App"}),`
`,n.jsx(e.p,{children:"Covenient for live-reload capacitor development."}),`
`,n.jsxs(e.ol,{children:[`
`,n.jsx(e.li,{children:"Manually start a proxy:"}),`
`]}),`
`,n.jsx(e.p,{children:n.jsx(e.code,{children:"docker run -it --rm -d -p 80:80 --name proxy -v ./local.nginx.conf:/etc/nginx/nginx.conf nginx"})}),`
`,n.jsxs(e.ol,{start:"2",children:[`
`,n.jsxs(e.li,{children:["Start Backend & Redis service ",n.jsx(e.code,{children:"docker compose up backend redis"})]}),`
`,n.jsxs(e.li,{children:["Start the frontend: ",n.jsx(e.code,{children:"cd ./frontend/ && npm run dev"})]}),`
`]}),`
`,n.jsx(e.p,{children:"(optional) Native development:"}),`
`,n.jsxs(e.ol,{start:"4",children:[`
`,n.jsxs(e.li,{children:["Prerender frontend ",n.jsx(e.code,{children:"npm run build && node ./preRender.js"})]}),`
`,n.jsx(e.li,{children:"Start native apps:"}),`
`]}),`
`,n.jsx(e.pre,{children:n.jsx(e.code,{className:"language-bash",children:`npx cap sync
npx cap run android -l --external
`})})]})}function tn(t={}){const{wrapper:e}=t.components||{};return e?n.jsx(e,{...t,children:n.jsx(be,{...t})}):be(t)}function ve(t){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",...t.components};return n.jsxs(n.Fragment,{children:[n.jsx(e.h1,{children:"Helm deployment"}),`
`,n.jsx(e.p,{children:"Backend & Frontend can be deployed seperately but a current image url for both must be provided."}),`
`,n.jsxs(e.h2,{children:["Locally using ",n.jsx(e.code,{children:"microk8s"})]}),`
`,n.jsxs(e.p,{children:["Make sure you have ",n.jsx(e.a,{href:"https://microk8s.io/docs/getting-started",children:"setup & installed"})," ",n.jsx(e.code,{children:"microk8s"}),"."]}),`
`,n.jsxs(e.blockquote,{children:[`
`,n.jsxs(e.p,{children:[`We utelize microk8s for easly local developement to work with managed k8s ( AKS or EKS ) you may need to add extra annotations to the ingress or add a loadbalancer.
But for small scale deployment microk8s can also work `,n.jsx(e.a,{href:"https://blog.t1m.me/blog/microk8s-on-vps",children:"checkout tim's blog post on how this can be set-up"})]}),`
`]}),`
`,n.jsx(e.h3,{children:"Build & Install Helm"}),`
`,n.jsxs(e.ol,{children:[`
`,n.jsxs(e.li,{children:["Setup the env, ",n.jsx(e.code,{children:"vim .env"})]}),`
`]}),`
`,n.jsx(e.pre,{children:n.jsx(e.code,{className:"language-bash",children:`IMAGE_PREFIX="localhost:32000/open-chat-"
IMAGE_TAG="latest"
`})}),`
`,n.jsxs(e.ol,{start:"2",children:[`
`,n.jsx(e.li,{children:"Build Backend & Frontend"}),`
`]}),`
`,n.jsx(e.pre,{children:n.jsx(e.code,{className:"language-bash",children:`docker compose -f docker-compose.pro.yaml build
`})}),`
`,n.jsxs(e.ol,{start:"3",children:[`
`,n.jsx(e.li,{children:"Push to local micok8s registry"}),`
`]}),`
`,n.jsx(e.p,{children:"Setup and install microk8s on your system, then:"}),`
`,n.jsx(e.pre,{children:n.jsx(e.code,{className:"language-bash",children:`microk8s enable registry
docker compose -f docker-compose.pro.yaml push
`})}),`
`,n.jsxs(e.ol,{start:"4",children:[`
`,n.jsxs(e.li,{children:["Check default helm ",n.jsx(e.code,{children:"values.yaml"})," ( should be good to go )"]}),`
`]}),`
`,n.jsx(e.pre,{children:n.jsx(e.code,{className:"language-bash",children:`microk8s helm install -f ./helm/values.yaml open-chat ./helm
`})}),`
`,n.jsx(e.h4,{children:"Deploying services individually"}),`
`,n.jsxs(e.p,{children:["Currently ",n.jsx(e.code,{children:"frontend"})," & ",n.jsx(e.code,{children:"backend"})," services may be deployed seperately."]}),`
`,n.jsxs(e.ol,{children:[`
`,n.jsx(e.li,{children:"Build & Push only one service"}),`
`]}),`
`,n.jsx(e.pre,{children:n.jsx(e.code,{className:"language-bash",children:`docker compose -f docker-compose.pro.yaml <service-name> build
docker compose -f docker-compose.pro.yaml <service-name> push
`})}),`
`,n.jsxs(e.ol,{start:"2",children:[`
`,n.jsxs(e.li,{children:["Update OR retrieve the current helm ",n.jsx(e.code,{children:"values.yaml"})]}),`
`]}),`
`,n.jsxs(e.p,{children:["Either edit ",n.jsx(e.code,{children:"helm/values.yaml"}),` to include you already deployed images.
Or retrieve the current image url's:`]}),`
`,n.jsx(e.pre,{children:n.jsx(e.code,{className:"language-bash",children:`microk8s helm get values open-chat -o yaml > ./helm/values.yaml
`})}),`
`,n.jsxs(e.ol,{start:"3",children:[`
`,n.jsxs(e.li,{children:["Update the image url in ",n.jsx(e.code,{children:"helm/values.yaml"})," and install the service"]}),`
`]}),`
`,n.jsx(e.pre,{children:n.jsx(e.code,{className:"language-bash",children:`microk8s helm upgrade -f ./helm/values.yaml open-chat ./helm
`})}),`
`,n.jsx(e.h3,{children:"Uninstall Helm"}),`
`,n.jsx(e.pre,{children:n.jsx(e.code,{className:"language-bash",children:`microk8s helm uninstall open-chat
`})})]})}function rn(t={}){const{wrapper:e}=t.components||{};return e?n.jsx(e,{...t,children:n.jsx(ve,{...t})}):ve(t)}function je(t){const e={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...t.components};return n.jsxs(n.Fragment,{children:[n.jsx(e.h1,{children:"Github Actions CI/CD"}),`
`,n.jsxs(e.blockquote,{children:[`
`,n.jsx(e.p,{children:"This section is WIP"}),`
`]}),`
`,n.jsx(e.p,{children:"A collection of github actions and a k8s cluster maybe be used to manage the CI/CD process."}),`
`,n.jsx(e.h2,{children:"Setting up environment"}),`
`,n.jsxs(e.blockquote,{children:[`
`,n.jsxs(e.p,{children:["As this is a public repo it has access to ",n.jsx(e.a,{href:"https://docs.github.com/en/actions/deployment/targeting-different-environments/using-environments-for-deployment",children:"github environments"}),`
If you are using this in context of a private repo you may need to adjust the github actions.`]}),`
`]}),`
`,n.jsx(e.h3,{children:"Environment Secrets"}),`
`,n.jsx(e.p,{children:"You are required to configure the following:"}),`
`,n.jsxs(e.ul,{children:[`
`,n.jsxs(e.li,{children:[n.jsx(e.code,{children:"KUBECONFIG_B64"}),": a base64 encoded kubeconfig file"]}),`
`,n.jsxs(e.li,{children:[n.jsx(e.code,{children:"REGISTRY_PASSWORD"}),": a docker registry password"]}),`
`,n.jsxs(e.li,{children:[n.jsx(e.code,{children:"REGISTRY_HOST"}),": a docker registry host"]}),`
`,n.jsxs(e.li,{children:[n.jsx(e.code,{children:"REGISTRY_USER"}),": a docker registry user"]}),`
`,n.jsxs(e.li,{children:[n.jsx(e.code,{children:"BOT_TOKEN"}),": a scoped github token of bot account"]}),`
`]}),`
`,n.jsxs(e.p,{children:["All workflows accessing this enviroment require prior approval of ",n.jsx(H,{href:"https://github.com/tbscode",target:"_blank",children:"tbscode"})]}),`
`,n.jsx(e.h2,{children:"Using Github Actions"}),`
`,n.jsx(e.p,{children:"Actions are environment scoped they share the following parameters:"}),`
`,n.jsxs(e.ul,{children:[`
`,n.jsxs(e.li,{children:[n.jsx(e.code,{children:"DEPLOYMENT_TARGET"}),": Atm only ",n.jsx(e.code,{children:"staging"})," is supported"]}),`
`]}),`
`,n.jsx(e.h3,{children:"Install Open Chat"}),`
`,n.jsxs(e.p,{children:["Workflow: ",n.jsx(e.code,{children:"./github/workflows/install-open-chat.yml"})]}),`
`,n.jsx(e.p,{children:"This workflow should be used for the inital helm installation of a setup."}),`
`,n.jsxs(e.p,{children:["Installs the ",n.jsx(H,{href:"/docs/helm-deployment",target:"_blank",children:"open-chat helm chart"})," to ",n.jsx(H,{href:"staging-open-chat.msgmate.io",target:"_blank",children:"Open Chat Staging Server"}),"."]}),`
`,n.jsx(e.h3,{children:"Update Existing Installation"}),`
`,n.jsxs(e.p,{children:[n.jsx(e.em,{children:"Update Frontend"}),`
Workflow: `,n.jsx(e.code,{children:"./github/workflows/update-frontend.yml"})]}),`
`,n.jsxs(e.p,{children:[n.jsx(e.em,{children:"Update Backend"}),`
Workflow: `,n.jsx(e.code,{children:"./github/workflows/update-backend.yml"})]})]})}function ln(t={}){const{wrapper:e}=t.components||{};return e?n.jsx(e,{...t,children:n.jsx(je,{...t})}):je(t)}const ye={sidebarNav:[{title:"Getting Started",baseurl:"/docs",items:[{title:"Introduction",href:"/",items:[]},{title:"Docker Development",href:"/dev-docker",items:[]},{title:"Github Actions",href:"/workflows",items:[]},{title:"Capacitor Native App",href:"/dev-capacitor",items:[]},{title:"Helm deployment",href:"/helm-deployment",items:[]}]}]},Kn=[{route:"",component:en},{route:"dev-docker",component:nn},{route:"dev-capacitor",component:tn},{route:"helm-deployment",component:rn},{route:"workflows",component:ln}];var ke=1,on=.9,an=.8,sn=.17,te=.1,re=.999,cn=.9999,dn=.99,un=/[\\\/_+.#"@\[\(\{&]/,hn=/[\\\/_+.#"@\[\(\{&]/g,pn=/[\s-]/,Ae=/[\s-]/g;function oe(t,e,r,a,s,d,h){if(d===e.length)return s===t.length?ke:dn;var f=`${s},${d}`;if(h[f]!==void 0)return h[f];for(var g=a.charAt(d),p=r.indexOf(g,s),u=0,x,S,k,E;p>=0;)x=oe(t,e,r,a,p+1,d+1,h),x>u&&(p===s?x*=ke:un.test(t.charAt(p-1))?(x*=an,k=t.slice(s,p-1).match(hn),k&&s>0&&(x*=Math.pow(re,k.length))):pn.test(t.charAt(p-1))?(x*=on,E=t.slice(s,p-1).match(Ae),E&&s>0&&(x*=Math.pow(re,E.length))):(x*=sn,s>0&&(x*=Math.pow(re,p-s))),t.charAt(p)!==e.charAt(d)&&(x*=cn)),(x<te&&r.charAt(p-1)===a.charAt(d+1)||a.charAt(d+1)===a.charAt(d)&&r.charAt(p-1)!==a.charAt(d))&&(S=oe(t,e,r,a,p+1,d+2,h),S*te>x&&(x=S*te)),x>u&&(u=x),p=r.indexOf(g,p+1);return h[f]=u,u}function we(t){return t.toLowerCase().replace(Ae," ")}function mn(t,e,r){return t=r&&r.length>0?`${t+" "+r.join(" ")}`:t,oe(t,e,we(t),we(e),0,0,{})}var B='[cmdk-group=""]',le='[cmdk-group-items=""]',fn='[cmdk-group-heading=""]',de='[cmdk-item=""]',Se=`${de}:not([aria-disabled="true"])`,ae="cmdk-item-select",I="data-value",xn=(t,e,r)=>mn(t,e,r),Ie=l.createContext(void 0),U=()=>l.useContext(Ie),_e=l.createContext(void 0),ie=()=>l.useContext(_e),Me=l.createContext(void 0),Le=l.forwardRef((t,e)=>{let r=P(()=>{var o,i;return{search:"",value:(i=(o=t.value)!=null?o:t.defaultValue)!=null?i:"",filtered:{count:0,items:new Map,groups:new Set}}}),a=P(()=>new Set),s=P(()=>new Map),d=P(()=>new Map),h=P(()=>new Set),f=qe(t),{label:g,children:p,value:u,onValueChange:x,filter:S,shouldFilter:k,loop:E,disablePointerSelection:L=!1,vimBindings:$=!0,...q}=t,Y=l.useId(),z=l.useId(),V=l.useId(),R=l.useRef(null),v=En();_(()=>{if(u!==void 0){let o=u.trim();r.current.value=o,y.emit()}},[u]),_(()=>{v(6,ue)},[]);let y=l.useMemo(()=>({subscribe:o=>(h.current.add(o),()=>h.current.delete(o)),snapshot:()=>r.current,setState:(o,i,m)=>{var c,b,j;if(!Object.is(r.current[o],i)){if(r.current[o]=i,o==="search")Z(),O(),v(1,G);else if(o==="value"&&(m||v(5,ue),((c=f.current)==null?void 0:c.value)!==void 0)){let C=i??"";(j=(b=f.current).onValueChange)==null||j.call(b,C);return}y.emit()}},emit:()=>{h.current.forEach(o=>o())}}),[]),F=l.useMemo(()=>({value:(o,i,m)=>{var c;i!==((c=d.current.get(o))==null?void 0:c.value)&&(d.current.set(o,{value:i,keywords:m}),r.current.filtered.items.set(o,W(i,m)),v(2,()=>{O(),y.emit()}))},item:(o,i)=>(a.current.add(o),i&&(s.current.has(i)?s.current.get(i).add(o):s.current.set(i,new Set([o]))),v(3,()=>{Z(),O(),r.current.value||G(),y.emit()}),()=>{d.current.delete(o),a.current.delete(o),r.current.filtered.items.delete(o);let m=X();v(4,()=>{Z(),(m==null?void 0:m.getAttribute("id"))===o&&G(),y.emit()})}),group:o=>(s.current.has(o)||s.current.set(o,new Set),()=>{d.current.delete(o),s.current.delete(o)}),filter:()=>f.current.shouldFilter,label:g||t["aria-label"],disablePointerSelection:L,listId:Y,inputId:V,labelId:z,listInnerRef:R}),[]);function W(o,i){var m,c;let b=(c=(m=f.current)==null?void 0:m.filter)!=null?c:xn;return o?b(o,r.current.search,i):0}function O(){if(!r.current.search||f.current.shouldFilter===!1)return;let o=r.current.filtered.items,i=[];r.current.filtered.groups.forEach(c=>{let b=s.current.get(c),j=0;b.forEach(C=>{let A=o.get(C);j=Math.max(A,j)}),i.push([c,j])});let m=R.current;T().sort((c,b)=>{var j,C;let A=c.getAttribute("id"),J=b.getAttribute("id");return((j=o.get(J))!=null?j:0)-((C=o.get(A))!=null?C:0)}).forEach(c=>{let b=c.closest(le);b?b.appendChild(c.parentElement===b?c:c.closest(`${le} > *`)):m.appendChild(c.parentElement===m?c:c.closest(`${le} > *`))}),i.sort((c,b)=>b[1]-c[1]).forEach(c=>{let b=R.current.querySelector(`${B}[${I}="${encodeURIComponent(c[0])}"]`);b==null||b.parentElement.appendChild(b)})}function G(){let o=T().find(m=>m.getAttribute("aria-disabled")!=="true"),i=o==null?void 0:o.getAttribute(I);y.setState("value",i||void 0)}function Z(){var o,i,m,c;if(!r.current.search||f.current.shouldFilter===!1){r.current.filtered.count=a.current.size;return}r.current.filtered.groups=new Set;let b=0;for(let j of a.current){let C=(i=(o=d.current.get(j))==null?void 0:o.value)!=null?i:"",A=(c=(m=d.current.get(j))==null?void 0:m.keywords)!=null?c:[],J=W(C,A);r.current.filtered.items.set(j,J),J>0&&b++}for(let[j,C]of s.current)for(let A of C)if(r.current.filtered.items.get(A)>0){r.current.filtered.groups.add(j);break}r.current.filtered.count=b}function ue(){var o,i,m;let c=X();c&&(((o=c.parentElement)==null?void 0:o.firstChild)===c&&((m=(i=c.closest(B))==null?void 0:i.querySelector(fn))==null||m.scrollIntoView({block:"nearest"})),c.scrollIntoView({block:"nearest"}))}function X(){var o;return(o=R.current)==null?void 0:o.querySelector(`${de}[aria-selected="true"]`)}function T(){var o;return Array.from((o=R.current)==null?void 0:o.querySelectorAll(Se))}function ee(o){let i=T()[o];i&&y.setState("value",i.getAttribute(I))}function ne(o){var i;let m=X(),c=T(),b=c.findIndex(C=>C===m),j=c[b+o];(i=f.current)!=null&&i.loop&&(j=b+o<0?c[c.length-1]:b+o===c.length?c[0]:c[b+o]),j&&y.setState("value",j.getAttribute(I))}function he(o){let i=X(),m=i==null?void 0:i.closest(B),c;for(;m&&!c;)m=o>0?Nn(m,B):Cn(m,B),c=m==null?void 0:m.querySelector(Se);c?y.setState("value",c.getAttribute(I)):ne(o)}let pe=()=>ee(T().length-1),me=o=>{o.preventDefault(),o.metaKey?pe():o.altKey?he(1):ne(1)},fe=o=>{o.preventDefault(),o.metaKey?ee(0):o.altKey?he(-1):ne(-1)};return l.createElement(D.div,{ref:e,tabIndex:-1,...q,"cmdk-root":"",onKeyDown:o=>{var i;if((i=q.onKeyDown)==null||i.call(q,o),!o.defaultPrevented)switch(o.key){case"n":case"j":{$&&o.ctrlKey&&me(o);break}case"ArrowDown":{me(o);break}case"p":case"k":{$&&o.ctrlKey&&fe(o);break}case"ArrowUp":{fe(o);break}case"Home":{o.preventDefault(),ee(0);break}case"End":{o.preventDefault(),pe();break}case"Enter":if(!o.nativeEvent.isComposing&&o.keyCode!==229){o.preventDefault();let m=X();if(m){let c=new Event(ae);m.dispatchEvent(c)}}}}},l.createElement("label",{"cmdk-label":"",htmlFor:F.inputId,id:F.labelId,style:Rn},g),Q(t,o=>l.createElement(_e.Provider,{value:y},l.createElement(Ie.Provider,{value:F},o))))}),gn=l.forwardRef((t,e)=>{var r,a;let s=l.useId(),d=l.useRef(null),h=l.useContext(Me),f=U(),g=qe(t),p=(a=(r=g.current)==null?void 0:r.forceMount)!=null?a:h==null?void 0:h.forceMount;_(()=>{if(!p)return f.item(s,h==null?void 0:h.id)},[p]);let u=Oe(s,d,[t.value,t.children,d],t.keywords),x=ie(),S=M(v=>v.value&&v.value===u.current),k=M(v=>p||f.filter()===!1?!0:v.search?v.filtered.items.get(s)>0:!0);l.useEffect(()=>{let v=d.current;if(!(!v||t.disabled))return v.addEventListener(ae,E),()=>v.removeEventListener(ae,E)},[k,t.onSelect,t.disabled]);function E(){var v,y;L(),(y=(v=g.current).onSelect)==null||y.call(v,u.current)}function L(){x.setState("value",u.current,!0)}if(!k)return null;let{disabled:$,value:q,onSelect:Y,forceMount:z,keywords:V,...R}=t;return l.createElement(D.div,{ref:K([d,e]),...R,id:s,"cmdk-item":"",role:"option","aria-disabled":!!$,"aria-selected":!!S,"data-disabled":!!$,"data-selected":!!S,onPointerMove:$||f.disablePointerSelection?void 0:L,onClick:$?void 0:E},t.children)}),bn=l.forwardRef((t,e)=>{let{heading:r,children:a,forceMount:s,...d}=t,h=l.useId(),f=l.useRef(null),g=l.useRef(null),p=l.useId(),u=U(),x=M(k=>s||u.filter()===!1?!0:k.search?k.filtered.groups.has(h):!0);_(()=>u.group(h),[]),Oe(h,f,[t.value,t.heading,g]);let S=l.useMemo(()=>({id:h,forceMount:s}),[s]);return l.createElement(D.div,{ref:K([f,e]),...d,"cmdk-group":"",role:"presentation",hidden:x?void 0:!0},r&&l.createElement("div",{ref:g,"cmdk-group-heading":"","aria-hidden":!0,id:p},r),Q(t,k=>l.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?p:void 0},l.createElement(Me.Provider,{value:S},k))))}),vn=l.forwardRef((t,e)=>{let{alwaysRender:r,...a}=t,s=l.useRef(null),d=M(h=>!h.search);return!r&&!d?null:l.createElement(D.div,{ref:K([s,e]),...a,"cmdk-separator":"",role:"separator"})}),jn=l.forwardRef((t,e)=>{let{onValueChange:r,...a}=t,s=t.value!=null,d=ie(),h=M(u=>u.search),f=M(u=>u.value),g=U(),p=l.useMemo(()=>{var u;let x=(u=g.listInnerRef.current)==null?void 0:u.querySelector(`${de}[${I}="${encodeURIComponent(f)}"]`);return x==null?void 0:x.getAttribute("id")},[]);return l.useEffect(()=>{t.value!=null&&d.setState("search",t.value)},[t.value]),l.createElement(D.input,{ref:e,...a,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":g.listId,"aria-labelledby":g.labelId,"aria-activedescendant":p,id:g.inputId,type:"text",value:s?t.value:h,onChange:u=>{s||d.setState("search",u.target.value),r==null||r(u.target.value)}})}),yn=l.forwardRef((t,e)=>{let{children:r,label:a="Suggestions",...s}=t,d=l.useRef(null),h=l.useRef(null),f=U();return l.useEffect(()=>{if(h.current&&d.current){let g=h.current,p=d.current,u,x=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let S=g.offsetHeight;p.style.setProperty("--cmdk-list-height",S.toFixed(1)+"px")})});return x.observe(g),()=>{cancelAnimationFrame(u),x.unobserve(g)}}},[]),l.createElement(D.div,{ref:K([d,e]),...s,"cmdk-list":"",role:"listbox","aria-label":a,id:f.listId},Q(t,g=>l.createElement("div",{ref:K([h,f.listInnerRef]),"cmdk-list-sizer":""},g)))}),kn=l.forwardRef((t,e)=>{let{open:r,onOpenChange:a,overlayClassName:s,contentClassName:d,container:h,...f}=t;return l.createElement(Ee,{open:r,onOpenChange:a},l.createElement($e,{container:h},l.createElement(se,{"cmdk-overlay":"",className:s}),l.createElement(ce,{"aria-label":t.label,"cmdk-dialog":"",className:d},l.createElement(Le,{ref:e,...f}))))}),wn=l.forwardRef((t,e)=>M(r=>r.filtered.count===0)?l.createElement(D.div,{ref:e,...t,"cmdk-empty":"",role:"presentation"}):null),Sn=l.forwardRef((t,e)=>{let{progress:r,children:a,label:s="Loading...",...d}=t;return l.createElement(D.div,{ref:e,...d,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},Q(t,h=>l.createElement("div",{"aria-hidden":!0},h)))}),w=Object.assign(Le,{List:yn,Item:gn,Input:jn,Group:bn,Separator:vn,Dialog:kn,Empty:wn,Loading:Sn});function Nn(t,e){let r=t.nextElementSibling;for(;r;){if(r.matches(e))return r;r=r.nextElementSibling}}function Cn(t,e){let r=t.previousElementSibling;for(;r;){if(r.matches(e))return r;r=r.previousElementSibling}}function qe(t){let e=l.useRef(t);return _(()=>{e.current=t}),e}var _=typeof window>"u"?l.useEffect:l.useLayoutEffect;function P(t){let e=l.useRef();return e.current===void 0&&(e.current=t()),e}function K(t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}function M(t){let e=ie(),r=()=>t(e.snapshot());return l.useSyncExternalStore(e.subscribe,r,r)}function Oe(t,e,r,a=[]){let s=l.useRef(),d=U();return _(()=>{var h;let f=(()=>{var p;for(let u of r){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(p=u.current.textContent)==null?void 0:p.trim():s.current}})(),g=a.map(p=>p.trim());d.value(t,f,g),(h=e.current)==null||h.setAttribute(I,f),s.current=f}),s}var En=()=>{let[t,e]=l.useState(),r=P(()=>new Map);return _(()=>{r.current.forEach(a=>a()),r.current=new Map},[t]),(a,s)=>{r.current.set(a,s),e({})}};function $n(t){let e=t.type;return typeof e=="function"?e(t.props):"render"in e?e.render(t.props):t}function Q({asChild:t,children:e},r){return t&&l.isValidElement(e)?l.cloneElement($n(e),{ref:e.ref},r(e.props.children)):r(e)}var Rn={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Dn=Ee,An=$e,Pe=l.forwardRef(({className:t,...e},r)=>n.jsx(se,{ref:r,className:N("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));Pe.displayName=se.displayName;const Fe=l.forwardRef(({className:t,children:e,...r},a)=>n.jsxs(An,{children:[n.jsx(Pe,{}),n.jsxs(ce,{ref:a,className:N("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[e,n.jsxs(Qe,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[n.jsx(Ue,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Fe.displayName=ce.displayName;const In=l.forwardRef(({className:t,...e},r)=>n.jsx(Re,{ref:r,className:N("text-lg font-semibold leading-none tracking-tight",t),...e}));In.displayName=Re.displayName;const _n=l.forwardRef(({className:t,...e},r)=>n.jsx(De,{ref:r,className:N("text-sm text-muted-foreground",t),...e}));_n.displayName=De.displayName;const Ge=l.forwardRef(({className:t,...e},r)=>n.jsx(w,{ref:r,className:N("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...e}));Ge.displayName=w.displayName;const Mn=({children:t,...e})=>n.jsx(Dn,{...e,children:n.jsx(Fe,{className:"overflow-hidden p-0",children:n.jsx(Ge,{className:"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:t})})}),Xe=l.forwardRef(({className:t,...e},r)=>n.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[n.jsx(Ye,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),n.jsx(w.Input,{ref:r,className:N("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...e})]}));Xe.displayName=w.Input.displayName;const Te=l.forwardRef(({className:t,...e},r)=>n.jsx(w.List,{ref:r,className:N("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...e}));Te.displayName=w.List.displayName;const Be=l.forwardRef((t,e)=>n.jsx(w.Empty,{ref:e,className:"py-6 text-center text-sm",...t}));Be.displayName=w.Empty.displayName;const Ln=l.forwardRef(({className:t,...e},r)=>n.jsx(w.Group,{ref:r,className:N("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...e}));Ln.displayName=w.Group.displayName;const qn=l.forwardRef(({className:t,...e},r)=>n.jsx(w.Separator,{ref:r,className:N("-mx-1 h-px bg-border",t),...e}));qn.displayName=w.Separator.displayName;const On=l.forwardRef(({className:t,...e},r)=>n.jsx(w.Item,{ref:r,className:N("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...e}));On.displayName=w.Item.displayName;function Pn(){const[t,e]=l.useState(!1);return l.useEffect(()=>{const r=a=>{a.key==="k"&&(a.metaKey||a.ctrlKey)&&(a.preventDefault(),e(s=>!s))};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[]),n.jsxs(Mn,{open:t,onOpenChange:e,children:[n.jsx(Xe,{placeholder:"(NOT IMPLEMENTED) Type a command or search..."}),n.jsx(Te,{children:n.jsx(Be,{children:"No results found."})})]})}function Ne({items:t,pathname:e}){return t.length?n.jsx("div",{className:"w-full",children:t.map((r,a)=>{var s;return n.jsxs("div",{className:N("pb-4"),children:[n.jsx("h4",{className:"mb-1 rounded-md px-2 py-1 font-semibold",children:r.title}),((s=r==null?void 0:r.items)==null?void 0:s.length)&&n.jsx(Fn,{baseurl:r.baseurl,items:r.items,pathname:e})]},a)})}):null}function Fn({baseurl:t,items:e,pathname:r}){return e!=null&&e.length?n.jsx("div",{className:"grid grid-flow-row auto-rows-max",children:e.map((a,s)=>a.href&&!a.disabled?n.jsxs("a",{href:t+a.href,className:N("group flex w-full items-center rounded-md border border-transparent px-2 py-1 hover:underline",a.disabled&&"cursor-not-allowed opacity-60",r===a.href?"font-medium text-foreground":"text-muted-foreground"),target:a.external?"_blank":"",rel:a.external?"noreferrer":"",children:[a.title,a.label&&n.jsx("span",{className:"ml-2 rounded-md bg-[#adfa1d] px-1.5 py-0.5 leading-none text-[#000000] no-underline group-hover:no-underline",children:a.label})]},s):n.jsxs("span",{className:N("flex w-full cursor-not-allowed items-center rounded-md p-2 text-muted-foreground hover:underline",a.disabled&&"cursor-not-allowed opacity-60"),children:[a.title,a.label&&n.jsx("span",{className:"ml-2 rounded-md bg-muted px-1.5 py-0.5 leading-none text-muted-foreground no-underline group-hover:no-underline",children:a.label})]},s))}):null}const He="ScrollArea",[Ke,Un]=ze(He),[Gn,Yn]=Ke(He),Ce=l.forwardRef((t,e)=>{const{__scopeScrollArea:r,type:a="hover",dir:s,scrollHideDelay:d=600,...h}=t,[f,g]=l.useState(null),[p,u]=l.useState(null),[x,S]=l.useState(null),[k,E]=l.useState(null),[L,$]=l.useState(null),[q,Y]=l.useState(0),[z,V]=l.useState(0),[R,v]=l.useState(!1),[y,F]=l.useState(!1),W=Ve(e,G=>g(G)),O=We(s);return l.createElement(Gn,{scope:r,type:a,dir:O,scrollHideDelay:d,scrollArea:f,viewport:p,onViewportChange:u,content:x,onContentChange:S,scrollbarX:k,onScrollbarXChange:E,scrollbarXEnabled:R,onScrollbarXEnabledChange:v,scrollbarY:L,onScrollbarYChange:$,scrollbarYEnabled:y,onScrollbarYEnabledChange:F,onCornerWidthChange:Y,onCornerHeightChange:V},l.createElement(D.div,Je({dir:O},h,{ref:W,style:{position:"relative","--radix-scroll-area-corner-width":q+"px","--radix-scroll-area-corner-height":z+"px",...t.style}})))}),Xn="ScrollAreaScrollbar";Ke(Xn);function zn({children:t,pathname:e}){return n.jsxs(n.Fragment,{children:[n.jsx(Pn,{}),n.jsx(Ze,{children:n.jsx(Ce,{className:"h-full py-6 pl-8 pr-6 lg:py-8",children:n.jsx(Ne,{items:ye.sidebarNav,pathname:e})})}),n.jsx("div",{className:"border-b",children:n.jsxs("div",{className:"container flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[320px_minmax(0,1fr)] md:text-xl lg:gap-10",children:[n.jsx("aside",{className:"fixed top-14 z-30 -ml-2 hidden h-[calc(100vh-3.7rem)] w-full shrink-0 md:sticky md:block bg-base-200 rounded-xl",children:n.jsx(Ce,{className:"h-full py-6 pl-8 pr-6 lg:py-8",children:n.jsx(Ne,{items:ye.sidebarNav,pathname:e})})}),n.jsx("div",{className:"article prose pt-10",children:t})]})})]})}export{zn as D,en as M,Kn as p};
